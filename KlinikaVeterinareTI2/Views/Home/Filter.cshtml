@model KlinikaVeterinareTI2.ViewModels.StatisticsViewModel
@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer localizer
@{
    ViewData["Title"] = localizer["lblFilter"];
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h3 class="text-center font-weight-bold mt-5">@ViewData["Title"]</h3>
<div class="container">
    <hr />
    <form method="post">
        <div class="row offset-md-2">
            <div class="form-group col-md-3">
                <label asp-for="YearFrom">@localizer["lblYearFrom"]</label>
                @Html.DropDownListFor(m => m.YearFrom, Model.YearFromSelectList, $"-- {localizer.GetString("All")} --", new { @class = "form-control" })
            </div>
            <div class="form-group col-md-3">
                <label asp-for="YearTo">@localizer["lblYearTo"]</label>
                @Html.DropDownListFor(m => m.YearTo, Model.YearToSelectList, $"-- {localizer.GetString("All")} --", new { @class = "form-control" })
            </div>
            <div class="form-group col-md-3">
                <label asp-for="AnimalFamily">@localizer["lblFamily"]</label>
                @Html.DropDownListFor(m => m.AnimalFamily, Model.AnimalFamilySelectList, $"-- {localizer.GetString("All")} --", new { @class = "form-control" })
            </div>
        </div>
        <div class="row offset-md-2">
            <div class="form-group col-md-3">
                <label asp-for="AnimalRace">@localizer["lblRace"]</label>
                @Html.DropDownListFor(m => m.AnimalRace, Model.AnimalRaceSelectList, $"-- {localizer.GetString("All")} --", new { @class = "form-control" })
            </div>
            <div class="form-group col-md-3">
                <label asp-for="AnimalGender">@localizer["lblGender"]</label>
                @Html.DropDownListFor(m => m.AnimalGender, Model.AnimalGenderSelectList, $"-- {localizer.GetString("All")} --", new { @class = "form-control" })
            </div>
            <div class="form-group col-md-3">
                <label asp-for="Veterinary">@localizer["lblVeterinarian"]</label>
                @Html.DropDownListFor(m => m.Veterinary, Model.VeterinarySelectList, $"-- {localizer.GetString("All")} --", new { @class = "form-control" })
            </div>
        </div>
        <div class="row offset-md-5">
            <div class="form-group col-md-3">
                <input type="submit" class="btn btn-primary form-control" value="@localizer["btnSearch"]" />
            </div>
        </div>
    </form>

    <hr />

    <div class="accordion" id="accordionExample">
        <div class="card">
            <div class="card-header" id="headingOne">
                <h2 class="mb-0 ">
                    <button class="btn btn-link btn-block d-flex justify-content-between" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                        @localizer["lblResult"]
                        <i class="fas fa-arrow-down"></i>
                    </button>
                </h2>
            </div>

            <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionExample">
                <div class="card-body">
                    <table class="table table-striped table-bordered" width="100%" id="tblFilteredVisits">
                        <thead>
                            <tr>
                                <th>
                                    @localizer["lblVisitDate"]
                                </th>
                                <th>
                                    @localizer["lblAnimalName"]
                                </th>
                                <th>
                                    @localizer["lblRace"]
                                </th>
                                <th>
                                    @localizer["lblFamily"]
                                </th>
                                <th>
                                    @localizer["lblGender"]
                                </th>
                                <th>
                                    @localizer["lblOwner"]
                                </th>
                                <th>
                                    @localizer["lblVeterinarian"]
                                </th>
                                @*<th>
                                        Diagnoza
                                    </th>*@
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model.FilteredVisits != null)
                            {
                                foreach (var item in Model.FilteredVisits)
                                {
                                    <tr>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Date)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Animal.Name)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Animal.Race.Name)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Animal.Family.Name)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Animal.Gender)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Owner.FullName)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.Veterinarian.FullName)
                                        </td>
                                        @*<td>
                                                @Html.DisplayFor(modelItem => item.Diagnosis)
                                            </td>*@
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="7" class="text-center"><i class="fas fa-frown"></i>&nbsp; @localizer["lblNoReports"]</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            $('#tblFilteredVisits').DataTable({
                'language': {
                    "sEmptyTable": "@localizer["sEmptyTable"]",
                    "sInfo": "@localizer["sInfo"]",
                    "sInfoEmpty": "@localizer["sInfoEmpty"]",
                    "sInfoFiltered": "(@localizer["sInfoFiltered"])",
                    "sInfoPostFix": "",
                    "sInfoThousands": ",",
                    "sLengthMenu": "@localizer["sLengthMenu"]",
                    "sLoadingRecords": "@localizer["sLoadingRecords"]",
                    "sProcessing": "@localizer["sProcessing"]",
                    "sSearch": "@localizer["sSearch"]",
                    "sZeroRecords": "@localizer["sZeroRecords"]",
                    "oPaginate": {
                        "sFirst": "@localizer["sFirst"]",
                        "sLast": "@localizer["sLast"]",
                        "sNext": "@localizer["sNext"]",
                        "sPrevious": "@localizer["sPrevious"]"
                    },
                    "oAria": {
                        "sSortAscending": ": @localizer["sSortAscending"]",
                        "sSortDescending": ": @localizer["sSortDescending"]"
                    }
                }
            });
        });
    </script>
}
